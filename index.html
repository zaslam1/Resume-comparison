<!DOCTYPE html>
<html>
<head>
    <title>Resume Matching</title>
</head>
<body>
    <h1>Upload Job Description and Resume</h1>
    
    <h2>Job Description</h2>
    <form id="job-description-form">
        <label for="jd-file">Upload Job Description File:</label>
        <input type="file" id="jd-file" name="jd-file" accept=".txt,.pdf,.doc,.docx">
        <br><br>
        <label for="jd-text">Or Paste Job Description Text:</label>
        <textarea id="jd-text" name="jd-text" rows="10" cols="50"></textarea>
        <br><br>
        <button type="submit">Submit Job Description</button>
    </form>
    
    <h2>Resume</h2>
    <form id="resume-form" style="display:none;">
        <label for="resume-file">Upload Resume File:</label>
        <input type="file" id="resume-file" name="resume-file" accept=".txt,.pdf,.doc,.docx">
        <br><br>
        <label for="resume-text">Or Paste Resume Text:</label>
        <textarea id="resume-text" name="resume-text" rows="10" cols="50"></textarea>
        <br><br>
        <button type="submit">Submit Resume</button>
    </form>
    
    <div id="results" style="display:none;">
        <h2>Results</h2>
        <p id="similarity-score"></p>
        <p id="interpretation"></p>
        <p id="recommendations"></p>
    </div>
    
    <script>
        const jobDescriptionForm = document.getElementById('job-description-form');
        const resumeForm = document.getElementById('resume-form');
        const resultsDiv = document.getElementById('results');

        jobDescriptionForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const formData = new FormData();
            
            const jdFile = document.getElementById('jd-file').files[0];
            const jdText = document.getElementById('jd-text').value;

            if (jdFile) {
                formData.append('file', jdFile);
            } else if (jdText) {
                formData.append('text', jdText);
            } else {
                alert("Please provide either a job description file or text.");
                return;
            }

            const response = await fetch('https://aaf3-34-145-136-52.ngrok-free.app/upload_job_description', {
                method: 'POST',
                body: formData
            });
            const result = await response.json();
            if (result.message) {
                alert(result.message);
                resumeForm.style.display = 'block';
            } else {
                alert(result.error);
            }
        });

        resumeForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const formData = new FormData();
            
            const resumeFile = document.getElementById('resume-file').files[0];
            const resumeText = document.getElementById('resume-text').value;

            if (resumeFile) {
                formData.append('file', resumeFile);
            } else if (resumeText) {
                formData.append('text', resumeText);
            } else {
                alert("Please provide either a resume file or text.");
                return;
            }

            const response = await fetch('https://aaf3-34-145-136-52.ngrok-free.app/upload_resume', {
                method: 'POST',
                body: formData
            });
            const result = await response.json();
            if (result.similarity_score !== undefined) {
                resultsDiv.style.display = 'block';
                document.getElementById('similarity-score').innerText = `Similarity Score: ${result.similarity_score}`;
                document.getElementById('interpretation').innerText = result.interpretation;
                document.getElementById('recommendations').innerText = result.recommendations;
            } else {
                alert(result.error);
            }
        });
    </script>
</body>
</html>
